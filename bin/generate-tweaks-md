#!/bin/env php
<?php

declare(strict_types = 1);

define( 'ABSPATH', dirname( __DIR__, 4 ) . '/wp/' );
define( 'WPINC', 'wp-includes' );

require ABSPATH . WPINC . '/functions.php';
require ABSPATH . WPINC . '/post.php';

require dirname( __DIR__ ) . '/php/fn-settings.php';

gen();

function gen(): void {

	$md = '## Tweaks' . PHP_EOL . PHP_EOL;

	foreach ( \Nextgenthemes\WPtweak\settings_data() as $key => $setting ) {
		$md .= '* **' . $setting['label'] . '**' . PHP_EOL;

		if ( ! empty( $setting['description'] ) ) {
			$md .= '<br>' . $setting['description'] . PHP_EOL;
		}
	}

	// phpcs:ignore
	file_put_contents( __DIR__ . '/tweaks.md', $md );
}

function __( string $text ): string {
	return $text;
}

function esc_html( string $text ): string {
	return $text;
}

// phpcs:ignore
function wp_kses( $content, $allowed_html, $allowed_protocols = array() ) {
	return $content;
}

function get_bloginfo( string $key ): string {

	switch ( $key ) {
		case 'url':
			return 'https://example.org';
		case 'version':
			return '1.0';
		default:
			die( 'not implemented in dummy' );
	}
}

function wp_generator(): void {
	echo 'WordPress/6.7.1; https://example.org';
}
